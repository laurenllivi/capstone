{% load staticfiles %}

<form id="htmlFindForm" action="{% url 'update_find_form' %}" method="post">
    {% csrf_token %}
    <script language="javascript" type="text/javascript" src="{% static 'noUiSlider.8.1.0/nouislider.js' %}"></script>
    <script src="{% static 'js/maplace.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/geosearch.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        setLocations({{ search_location|safe }}, {{ location_data|safe }}, {{ price_per_hour_range|safe }});
    </script>

    <div class="leftdiv">
        <h3>Find A Venue</h3>
        {{form.errors}}
           <div class="half-width">
               Within:
               {{ form.within_miles }}
               Event Date:
               {{ form.event_date }}
               Price Per Hour
               <br/>
               <div class="half-width">
                    From
                    {{ form.price_per_hour_lower }}
               </div>
               <div class="half-width">
                   To
                   {{ form.price_per_hour_upper }}
               </div>

           </div>
            <div class="half-width">
                Location
                {{ form.location }}
                Venue Type
                {{ form.venue_type }}

           </div>
            <input type="submit" value="Search">
        <!--<hr class="hr-style" />-->

        <!--<div class="slider-div">-->

            <!--<div class="slider-container">-->
                <!--<div id="nonlinear" class="noUi-target noUi-ltr noUi-horizontal noUi-background">-->
                <!--</div>-->
                <!--<br/>-->

                <!--<div class="slider left-slider">-->
                    <!--<span class="example-val" id="lower-value">{{form.price_per_hour_lower.value}}</span>-->
                <!--</div>-->

                <!--<div class="slider right-slider">-->
                    <!--<span class="example-val" id="upper-value">{{form.price_per_hour_upper.value}}</span>-->
                <!--</div>-->


            <!--</div>-->
        <!--</div>&lt;!&ndash; slider-div &ndash;&gt;-->

        <hr class="hr-style" />


        <!-- the results of the search -->
        <div class="results-wrapper">
            <div class="results-container">

                {% for venue in venues %}
                    <div class="venue-result">
                        <a href="view-venue.html">
                            {% if venue_pics_dict|get_item:venue.id == None %}
                                <img class="tiny-camera-icon venue-pic" src="/static/images/camera-icon.png"/></a>
                                <img class="venue-pic" src="" />
                            {% else %}
                                <img class="venue-pic" src="/static/images/venue-images/{{ venue.id }}/{{ venue_pics_dict|get_item:venue.id }}"/>
                            {% endif %}
                            <div class="price-label">${{ venue.price_per_hour }}</div>
                            <div class="favorite-container">
                                <i class="fa fa-heart-o fa-2x"></i>
                            </div>
                        </a>
                    </div>
                {% endfor %}

            </div><!-- results-container -->
        </div><!-- results-wrapper -->
    </div>
    <div class="rightdiv">
        <div id="gmap-circles"></div>
    </div>
</form>

<script>
    $body = $("body");

    $(document).on({
        ajaxStart: function() { $body.addClass("loading");    },
         ajaxStop: function() { $body.removeClass("loading"); }
    });

    $(document).ready(function() {
        //var lowerPrice = document.getElementById('lower-value').innerHTML;
        //var upperPrice = document.getElementById('upper-value').innerHTML;
        //alert(lowerPrice, upperPrice);

        $('#htmlFindForm').ajaxForm({
            // target identifies the element(s) to update with the server response
            target: '#find-container',
            //data: {lower: lowerPrice, upper: upperPrice}
        });

        pageSetup();
    });
</script>